<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title }}</title>
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" />
    <link rel="stylesheet" href="{{ '/assets/styles.css' | relative_url }}">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">

</head>
<body>
<header class="site-header">
  <nav aria-label="Navigation principale">
    <ul class="menu">
      <li><a href="{{ '/' | relative_url }}">Accueil</a></li>

      <li class="has-sub">
        <a href="{{ '/docs/royaumes/' | relative_url }}" aria-haspopup="true" aria-expanded="false">Royaumes</a>
        <ul class="submenu">
          {% assign pages = site.pages | where: "category", "royaumes" | sort: "title" %}
          {% for p in pages %}
            <li><a href="{{ p.url | relative_url }}">{{ p.title }}</a></li>
          {% endfor %}
        </ul>
      </li>

      <li class="has-sub">
        <a href="{{ '/docs/regions/' | relative_url }}" aria-haspopup="true" aria-expanded="false">RÃ©gions</a>
        <ul class="submenu">
          {% assign pages = site.pages | where: "category", "regions" | sort: "title" %}
          {% for p in pages %}
            <li><a href="{{ p.url | relative_url }}">{{ p.title }}</a></li>
          {% endfor %}
        </ul>
      </li>

      <li class="has-sub">
        <a href="{{ '/docs/villes/' | relative_url }}" aria-haspopup="true" aria-expanded="false">Villes</a>
        <ul class="submenu">
          {% assign pages = site.pages | where: "category", "villes" | sort: "title" %}
          {% for p in pages %}
            <li><a href="{{ p.url | relative_url }}">{{ p.title }}</a></li>
          {% endfor %}
        </ul>
      </li>

      <li class="has-sub">
        <a href="{{ '/docs/fleuves/' | relative_url }}" aria-haspopup="true" aria-expanded="false">Fleuves</a>
        <ul class="submenu">
          {% assign pages = site.pages | where: "category", "fleuves" | sort: "title" %}
          {% for p in pages %}
            <li><a href="{{ p.url | relative_url }}">{{ p.title }}</a></li>
          {% endfor %}
        </ul>
      </li>
    </ul>
  </nav>
</header>

    <main>
        {{ content }}
    </main>
  

  <script src="https://cdn.jsdelivr.net/gh/mcstudios/glightbox/dist/js/glightbox.min.js"></script>
  <script>
    const lightbox = GLightbox({
      selector: '.glightbox',
      zoomable: true,
      touchNavigation: true
    });

    // Mobile menu: toggle submenu on tap instead of navigating
    (function() {
      const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

      document.querySelectorAll('.has-sub > a').forEach(function(link) {
        link.addEventListener('click', function(e) {
          // Only intercept on touch devices or narrow screens
          if (!isTouchDevice && window.innerWidth > 700) return;

          const parent = this.parentElement;
          const submenu = parent.querySelector('.submenu');
          const isOpen = parent.classList.contains('submenu-open');

          // Close all other submenus
          document.querySelectorAll('.has-sub.submenu-open').forEach(function(el) {
            if (el !== parent) {
              el.classList.remove('submenu-open');
              el.querySelector('a').setAttribute('aria-expanded', 'false');
            }
          });

          if (!isOpen) {
            // First tap: open submenu, don't navigate
            e.preventDefault();
            parent.classList.add('submenu-open');
            this.setAttribute('aria-expanded', 'true');
          }
          // Second tap (isOpen true): allow navigation to the page
        });
      });

      // Close submenus when tapping outside
      document.addEventListener('click', function(e) {
        if (!e.target.closest('.has-sub')) {
          document.querySelectorAll('.has-sub.submenu-open').forEach(function(el) {
            el.classList.remove('submenu-open');
            el.querySelector('a').setAttribute('aria-expanded', 'false');
          });
        }
      });
    })();
  </script>
</body>
</html>
